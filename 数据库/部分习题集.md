# 部分习题集

### 595

``` mysql
select name, population, area from World where area > 3000000 or population > 25000000;
```

### 627

``` mysql
update salary set sex = char(ascii(sex) ^ ascii("m") ^ ascii("f"));
```

需要用到异或，但是异或只限于整型间运算，需要ascii和char方法。

* ascii返回字符串str的最左面字符(left)的ASCII代码值。如果str是空字符串，返回0。如果str是NULL，返回NULL

* char将ASCII码转为字符并拼成字符串，可以接受多个整型参数。

因为两个相同的数异或为0，而0异或任何数都为它本身，所以将sex字段值参与"m"和"f"的异或。

### 620

``` mysql
select * from cinema where mod(id, 2) = 1 and description <> "boring" order by rating desc;
```

### 596

``` mysql
select class from courses group by class having count(distinct student) >= 5;
```

利用having和聚合方法筛选组别。

### 182

``` mysql
select Email from Person group by Email having count(distinct Id) > 1;
```

所谓重复的，就是出现次数 > 1的组别。

### 196

``` mysql
delete from Person where Id not in (select min(Id) from Person group by Email);	# 错误示范

delete from Person where Id not in (select small from (select min(Id) as small from Person group by Email) as tmp); # 正确写法
```

一般思路是获取所有保留（组内最小Id）的Id号，然后删除的话就限制Id不在这个集合内即可。但是如果按第一种写法的话是错误的，理由是不能修饰(update, delete)select部分所用的表。按照第一种写法，delete和select用的都是Person，所以冲突。我们可以多嵌套一个select来“欺骗”数据库，如第二种写法，这样（外层）select用的相当于是一个视图tmp，而delete用的是Person，所以不冲突。

另外，注意如果**from后面的子查询**必须要指定一个**别名**，不然会报错。