### 代码

``` java
class Solution {
    public boolean isNumber(String s) {
        s = s.trim();
        int n = s.length();
        char[] ss = s.toCharArray();
        if (n == 0)
            return false;
        int i = 0;
        // 符号
        if (i < n && (ss[i] == '-' || ss[i] == '+'))
            i++;
        // 整数
        if (i >= n || (!Character.isDigit(ss[i]) && ss[i] != '.'))
            return false;
        while (i < n && Character.isDigit(ss[i]))
            i++;
        // 小数
        if (i < n && ss[i] == '.') {
            i++;
            if ((i - 2 < 0 || !Character.isDigit(ss[i - 2])) && (i >= n || !Character.isDigit(ss[i])))
                return false; 
            while (i < n && Character.isDigit(ss[i]))
                i++;
        }
      	// 指数
        if (i < n && (ss[i] == 'e' || ss[i] == 'E')) {
            i++;
            if (i < n && (ss[i] == '-' || ss[i] == '+'))
                i++;
            if (i >= n || !Character.isDigit(ss[i]))
                return false;
            while (i < n && Character.isDigit(ss[i]))
                i++;
        }
        return i == n;
    }
}
```



### 思路

和剑指的数值字符串比较相似，但是在LeetCode上判定条件比较恶心，不像牛客的比较宽松。如果熟悉正则表达式的话直接一句话就能搞定，不熟悉的只能老老实实遍历。

* 首先由于测试样例会出现前后多余空格的情况，所以先用trim方法压缩字符串。
  * trim方法一定要放在开头，因为后面的操作都是以压缩后的字符串为基础的。
  * trim方法其实也可以自己写。从前往后遍历跳过连续的空格，然后从后往前遍历跳过连续的空格。
* 考虑特殊情况，即空串的情况。必然是返回false的。
* 然后我们维护一个遍历指针 i，从0开始遍历。

对于一个有效数字来说，其组成可以分成以下几个部分，是按照顺序来的：

* 符号。
  * 符号是可有可无的，如果存在（-/+）就跳过。i++
* 整数部分。
  * 整数部分是必须要存在的，但一种情况除外，就是小数点的情况。如 .5 表示 0.5。
  * 这里我们直接考虑不存在的情况。如果 i >= n 或者 ss[i] **既不是数字也不是小数点**，则直接返回false。
  * 最后我们还要跳过整数部分，跳过连续的数字即可。
* 小数部分。
  * 小数部分不一定存在。
  * 如果存在（.），i++。
    * 这时候 i 表示的理应是小数数字部分，但实际上这部分也不一定存在。如 3. 表示 3.0。
    * 考虑小数数字部分不存在的情况，即 i >= n 或者 ss[i] 不是数字。同时，如果这时 i - 2 < 0 或者 ss[i - 2] 不是数字，说明**小数点前后都不存在数字**，即会出现独立的小数点的情况，如 . ，此时直接返回false。
    * 类似地，跳过小数数字部分。
* 指数部分。
  * 指数部分不一定存在。
  * 如果存在（e/E），i++。
    * 指数数字部分可能带符号，和前面的符号判断一样，可有可无，有就跳过。i++
    * 指数数字部分是一定要存在的，如果 i >= n 或者 ss[i] 不是数字，则直接返回false。
    * 类似地，跳过指数数字部分。

最后只要检查是不是遍历完了，即 i 是否 == n 即可。如果是，则说明是有效数字；否则，不是。



### 总结

和剑指（牛客）的后台判定的区别如下，个人感觉LeetCode的判定更严谨一些，大概。

* 剑指中不需要压缩字符串，没有多余空格。
* 剑指中整数部分是可有可无的。
* 剑指中小数点数字部分是一定要存在的。

最后总结一些容易出错的坑爹样例：

* e
* .
* e9
* 3.
* .1
* 1e